
/*
    Basic Malware Detection Rules
    These are sample rules for demonstration
*/

rule Suspicious_Embedded_PE
{
    meta:
        description = "Detects embedded PE files in images"
        severity = "high"
        author = "Security Scanner"
        
    strings:
        $pe_header = { 4D 5A }  // MZ header
        $pe_signature = "This program cannot be run in DOS mode"
        
    condition:
        $pe_header and $pe_signature
}

rule Suspicious_Script_Content
{
    meta:
        description = "Detects suspicious script content in image metadata"
        severity = "medium"
        
    strings:
        $script1 = "<script" nocase
        $script2 = "eval(" nocase
        $script3 = "document.write" nocase
        $script4 = "javascript:" nocase
        
    condition:
        any of them
}

rule Web_Shell_Patterns
{
    meta:
        description = "Detects web shell patterns"
        severity = "critical"
        
    strings:
        $shell1 = "system($_" nocase
        $shell2 = "exec($_" nocase
        $shell3 = "shell_exec(" nocase
        $shell4 = "passthru(" nocase
        $shell5 = "eval(base64_decode(" nocase
        
    condition:
        any of them
}
            